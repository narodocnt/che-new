<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –º–∞–ø–∞ –ß–µ—Ä–∫–∞—â–∏–Ω–∏</title>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; background: #f4f4f4; }
        .map-wrapper { position: relative; width: 900px; height: 600px; margin-top: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        
        /* –í–∞—à–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞ */
        #original-map { width: 100%; height: 100%; object-fit: contain; }

        /* –®–∞—Ä –∑—ñ SVG –∑–æ–Ω–∞–º–∏ */
        #interactive-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        }

        .hromada {
            fill: transparent;
            stroke: rgba(255,255,255,0.2);
            stroke-width: 2;
            cursor: pointer;
            transition: 0.3s;
        }

        .hromada:hover {
            fill: rgba(139, 0, 0, 0.4); /* –ß–µ—Ä–≤–æ–Ω–∏–π –ø—Ä–æ–∑–æ—Ä–∏–π –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ */
            stroke: #fff;
            stroke-width: 3;
        }

        .info-panel {
            position: absolute; background: white; padding: 15px; border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); display: none; pointer-events: none; z-index: 10;
        }
    </style>
</head>
<body>

    <h2>üé≠ –ö—É–ª—å—Ç—É—Ä–Ω–∞ –ë–∏—Ç–≤–∞ –ì—Ä–æ–º–∞–¥ –ß–µ—Ä–∫–∞—â–∏–Ω–∏</h2>

    <div class="map-wrapper">
        <img src="map.jpg" id="original-map">

        <svg id="interactive-layer" viewBox="0 0 900 600">
            <path class="hromada" data-name="–ó–≤–µ–Ω–∏–≥–æ—Ä–æ–¥—Å—å–∫–∞" d="M350,340 L400,340 L410,380 L390,410 L350,400 Z" />
            <path class="hromada" data-name="–ß–µ—Ä–∫–∞—Å—å–∫–∞" d="M540,250 L600,240 L620,290 L580,320 L530,300 Z" />
            <path class="hromada" data-name="–£–º–∞–Ω—Å—å–∫–∞" d="M180,450 L240,440 L250,500 L200,520 L170,490 Z" />
            <path class="hromada" data-name="–ó–æ–ª–æ—Ç–æ–Ω—ñ—Å—å–∫–∞" d="M520,150 L580,140 L600,200 L550,220 L510,190 Z" />
            <path class="hromada" data-name="–°–º—ñ–ª—è–Ω—Å—å–∫–∞" d="M510,340 L560,330 L580,380 L540,410 L500,390 Z" />
            <path class="hromada" data-name="–ö–∞–Ω—ñ–≤—Å—å–∫–∞" d="M420,130 L480,120 L500,180 L450,200 L410,170 Z" />
            <path class="hromada" data-name="–ß–∏–≥–∏—Ä–∏–Ω—Å—å–∫–∞" d="M630,350 L700,340 L720,410 L670,450 L620,420 Z" />
        </svg>

        <div id="info" class="info-panel"></div>
    </div>

    <script>
        const info = document.getElementById('info');
        let battleStats = {};

        // 1. –û—Ç—Ä–∏–º—É—î–º–æ –¥–∞–Ω—ñ –∑ –≤–∞—à–æ–≥–æ n8n
        async function fetchStats() {
            try {
                const response = await fetch('https://n8n.narodocnt.online/webhook/get-battle-stats');
                battleStats = await response.json();
                console.log("–î–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ:", battleStats);
            } catch (e) {
                console.error("–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ –∑ n8n");
            }
        }

        // 2. –õ–æ–≥—ñ–∫–∞ –≤–∑–∞—î–º–æ–¥—ñ—ó
        document.querySelectorAll('.hromada').forEach(zone => {
            zone.addEventListener('mousemove', (e) => {
                const name = zone.getAttribute('data-name');
                const score = battleStats[name] || 0;
                
                info.style.display = 'block';
                info.style.left = (e.pageX - 350) + 'px'; // –ö–æ—Ä–µ–∫—Ü—ñ—è –ø–æ–∑–∏—Ü—ñ—ó
                info.style.top = (e.pageY - 150) + 'px';
                
                info.innerHTML = `
                    <strong style="color:#8b0000; font-size:18px;">${name}</strong><br>
                    üèÜ –ë–∞–ª—ñ–≤ —É –±–∏—Ç–≤—ñ: <b>${score}</b><br>
                    üé≠ –ö–æ–ª–µ–∫—Ç–∏–≤—ñ–≤: <b>${Math.floor(score/5)}</b>
                `;
            });

            zone.addEventListener('mouseleave', () => {
                info.style.display = 'none';
            });
            
            zone.addEventListener('click', () => {
                alert("–í–∏ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É –≥—Ä–æ–º–∞–¥–∏: " + zone.getAttribute('data-name'));
            });
        });

        fetchStats();
    </script>
</body>
</html>
