<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Культурна Карта Черкащини</title>
    <style>
        body { margin: 0; padding: 20px; background: #333; display: flex; justify-content: center; }
        
        .map-wrapper { 
            position: relative; 
            /* Фіксуємо розмір контейнера точно як у картинки */
            width: 900px; 
            height: 736px; 
            background: #fff;
            line-height: 0; /* Прибирає мікро-відступ під картинкою */
        }

        #base-map { 
            width: 900px; 
            height: 736px; 
            display: block; 
        }

        svg { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 900px; 
            height: 736px; 
            pointer-events: none; /* Щоб кліки проходили крізь SVG на групи */
        }

        .badge { cursor: pointer; pointer-events: auto; transition: 0.2s; }
        .badge:hover { opacity: 0.8; }
        .badge circle { fill: #cc0000; stroke: white; stroke-width: 2; }
        .badge text { fill: white; font-family: Arial; font-size: 11px; font-weight: bold; }

        #popup {
            position: absolute; display: none; background: white;
            border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            padding: 15px; z-index: 1000; min-width: 200px; line-height: 1.4;
        }
    </style>
</head>
<body>

<div class="map-wrapper">
    <img src="map.jpg" id="base-map">
    <svg id="svg-layer" viewBox="0 0 900 736"></svg>
    
    <div id="popup">
        <div id="pop-name" style="font-weight:bold; color:#8b0000; margin-bottom:5px;"></div>
        <div id="pop-list"></div>
    </div>
</div>

<script src="hromadas-data.js"></script>
<script>
    const svg = document.getElementById('svg-layer');
    const popup = document.getElementById('popup');

    // Очищуємо SVG перед малюванням (про всяк випадок)
    svg.innerHTML = '';

    hromadasGeoJSON.features.forEach(h => {
        const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
        g.setAttribute("class", "badge");

        // Малюємо кружечок. Координати x та y беруться прямо з вашого файлу
        g.innerHTML = `
            <circle cx="${h.x}" cy="${h.y}" r="12" />
            <text x="${h.x}" y="${h.y + 4}" text-anchor="middle">0</text>
        `;

        g.onclick = (e) => {
            e.stopPropagation();
            const rect = document.querySelector('.map-wrapper').getBoundingClientRect();
            // Розрахунок позиції вікна відносно контейнера
            popup.style.display = 'block';
            popup.style.left = (h.x + 15) + 'px';
            popup.style.top = (h.y - 50) + 'px';
            document.getElementById('pop-name').innerText = h.name;
            document.getElementById('pop-list').innerText = "Колективи завантажуються...";
        };

        svg.appendChild(g);
    });

    document.addEventListener('click', () => popup.style.display = 'none');
</script>

</body>
</html>
