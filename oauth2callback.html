<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Google –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<h2>‚è≥ –ó–∞–≤–µ—Ä—à—É—î–º–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é —á–µ—Ä–µ–∑ Google‚Ä¶</h2>

<script>
(async () => {
  console.log("OAuth callback loaded");

  const params = new URLSearchParams(window.location.search);
  const code = params.get("code");

  if (!code) {
    document.body.innerHTML = "‚ùå Google –Ω–µ –ø–æ–≤–µ—Ä–Ω—É–≤ –∫–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó";
    return;
  }

  try {
    const res = await fetch(
      "https://n8n.narodocnt.online/webhook/google-signup",
      {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ code })
      }
    );

    if (!res.ok) {
      const text = await res.text();
      throw new Error("HTTP " + res.status + ": " + text);
    }

    document.body.innerHTML = `
      <h2>‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞</h2>
      <p>–ú–æ–∂–Ω–∞ –∑–∞–∫—Ä–∏–≤–∞—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É üéâ</p>
    `;

  } catch (err) {
    console.error(err);
    document.body.innerHTML = `
      <h2>‚ùå –ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó</h2>
      <pre>${err.message}</pre>
    `;
  }
})();
</script>

</body>
</html>
